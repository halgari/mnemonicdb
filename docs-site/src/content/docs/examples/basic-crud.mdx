---
title: Basic CRUD Operations
description: Interactive examples of basic Create, Read, Update, Delete operations
---

import LiveExample from '../../../components/LiveExample.astro';

Learn MnemonicDB's SQL interface through interactive examples. Each example runs in your browser using PGLite—no server required!

## Setting Up Schema

First, let's define some attributes for a "person" entity:

<LiveExample
  title="Define Person Attributes"
  code={`-- Start a transaction
CALL mnemonic_begin_tx();

-- Define person/name attribute using the admin view
INSERT INTO mnemonic_defined_attributes (ident, value_type, cardinality)
VALUES ('person/name', 'db.type/text', 'db.cardinality/one');

-- Define person/age attribute
INSERT INTO mnemonic_defined_attributes (ident, value_type, cardinality)
VALUES ('person/age', 'db.type/int4', 'db.cardinality/one');

-- Commit the transaction
CALL mnemonic_commit_tx();

-- Verify attributes were created
SELECT * FROM mnemonic_defined_attributes WHERE ident LIKE 'person/%'`}
/>

## Creating a View

Now let's create a view that combines our attributes:

<LiveExample
  title="Create Persons View"
  code={`-- Start a transaction
CALL mnemonic_begin_tx();

-- Create the persons view using the admin table
INSERT INTO mnemonic_defined_views (name, attributes, optional_attributes, doc)
VALUES ('persons', ARRAY['person/name', 'person/age'], '{}', 'Person entities');

-- Commit the transaction
CALL mnemonic_commit_tx();

-- Verify the view was created
SELECT * FROM mnemonic_views`}
/>

## INSERT: Creating Entities

Insert data through the view—triggers handle datom creation:

<LiveExample
  title="Insert Persons"
  code={`-- Start a transaction
CALL mnemonic_begin_tx();

-- Insert some people
INSERT INTO persons (name, age) VALUES ('Alice', 30);
INSERT INTO persons (name, age) VALUES ('Bob', 25);
INSERT INTO persons (name, age) VALUES ('Charlie', 35);

-- Commit the transaction
CALL mnemonic_commit_tx();

-- Query all persons
SELECT * FROM persons ORDER BY name`}
/>

## SELECT: Querying Data

Query data using standard SQL:

<LiveExample
  title="Query Persons"
  code={`-- Find people over 28
SELECT * FROM persons WHERE age > 28 ORDER BY age DESC`}
/>

## UPDATE: Modifying Entities

Update data through the view—old values are retracted, new values asserted:

<LiveExample
  title="Update a Person"
  code={`-- Start a transaction
CALL mnemonic_begin_tx();

-- Update Alice's age
UPDATE persons SET age = 31 WHERE name = 'Alice';

-- Commit the transaction
CALL mnemonic_commit_tx();

-- Verify the update
SELECT * FROM persons WHERE name = 'Alice'`}
/>

## Viewing the Underlying Datoms

Let's peek at the actual datoms to see how updates work:

<LiveExample
  title="View Datoms"
  code={`-- See all name datoms (including retracted)
SELECT
  e,
  v AS name,
  tx AS asserted_tx,
  retracted_by
FROM attr_person_name
ORDER BY e, tx`}
/>

## DELETE: Removing Entities

Delete through the view—all datoms for that entity are retracted:

<LiveExample
  title="Delete a Person"
  code={`-- Start a transaction
CALL mnemonic_begin_tx();

-- Delete Bob
DELETE FROM persons WHERE name = 'Bob';

-- Commit the transaction
CALL mnemonic_commit_tx();

-- Verify deletion
SELECT * FROM persons ORDER BY name`}
/>

## Checking Retracted Datoms

The data isn't gone—just retracted:

<LiveExample
  title="View Retracted Datoms"
  code={`-- See retracted datoms
SELECT
  e,
  v AS name,
  tx AS asserted_tx,
  retracted_by
FROM attr_person_name
WHERE retracted_by IS NOT NULL`}
/>

## Key Takeaways

1. **Views look like tables**: Standard SQL INSERT/UPDATE/DELETE work
2. **Data is never deleted**: Updates create new datoms and retract old ones
3. **Full history preserved**: You can query retracted datoms for audit trails
4. **Explicit transactions**: Use `CALL mnemonic_begin_tx()` and `CALL mnemonic_commit_tx()` to group operations

Try modifying the examples above—the database resets when you click "Reset DB".
