---
title: Basic CRUD Operations
description: Interactive examples of basic Create, Read, Update, Delete operations
---

import LiveExample from '../../../components/LiveExample.astro';

Learn MnemonicDB's SQL interface through interactive examples. Each example runs in your browser using PGLite—no server required!

## Setting Up Schema

First, let's define some attributes for a "person" entity:

<LiveExample
  title="Define Person Attributes"
  code={`-- Define person/name attribute
INSERT INTO attr_db_ident (e, a, v_data, tx, retracted_by)
VALUES (300, 1, '"person/name"', 0, NULL);
INSERT INTO attr_db_valuetype (e, a, v_data, tx, retracted_by)
VALUES (300, 2, '100', 0, NULL);
INSERT INTO attr_db_cardinality (e, a, v_data, tx, retracted_by)
VALUES (300, 3, '200', 0, NULL);

-- Create the attribute table
CALL mnemonic_create_attr_table(300, 'person/name', 'db.type/text');

-- Define person/age attribute
INSERT INTO attr_db_ident (e, a, v_data, tx, retracted_by)
VALUES (301, 1, '"person/age"', 0, NULL);
INSERT INTO attr_db_valuetype (e, a, v_data, tx, retracted_by)
VALUES (301, 2, '101', 0, NULL);
INSERT INTO attr_db_cardinality (e, a, v_data, tx, retracted_by)
VALUES (301, 3, '200', 0, NULL);

CALL mnemonic_create_attr_table(301, 'person/age', 'db.type/int4');

-- Verify attributes were created
SELECT * FROM mnemonic_attributes WHERE ident LIKE 'person/%'`}
/>

## Creating a View

Now let's create a view that combines our attributes:

<LiveExample
  title="Create Persons View"
  code={`-- Create the persons view using the admin table
INSERT INTO mnemonic_defined_views (name, attributes, optional_attributes, doc)
VALUES ('persons', ARRAY['person/name', 'person/age'], '{}', 'Person entities');

-- Verify the view was created
SELECT * FROM mnemonic_views`}
/>

## INSERT: Creating Entities

Insert data through the view—triggers handle datom creation:

<LiveExample
  title="Insert Persons"
  code={`-- Insert some people
INSERT INTO persons (name, age) VALUES ('Alice', 30);
INSERT INTO persons (name, age) VALUES ('Bob', 25);
INSERT INTO persons (name, age) VALUES ('Charlie', 35);

-- Query all persons
SELECT * FROM persons ORDER BY name`}
/>

## SELECT: Querying Data

Query data using standard SQL:

<LiveExample
  title="Query Persons"
  code={`-- Find people over 28
SELECT * FROM persons WHERE age > 28 ORDER BY age DESC`}
/>

## UPDATE: Modifying Entities

Update data through the view—old values are retracted, new values asserted:

<LiveExample
  title="Update a Person"
  code={`-- Update Alice's age
UPDATE persons SET age = 31 WHERE name = 'Alice';

-- Verify the update
SELECT * FROM persons WHERE name = 'Alice'`}
/>

## Viewing the Underlying Datoms

Let's peek at the actual datoms to see how updates work:

<LiveExample
  title="View Datoms"
  code={`-- See all name datoms (including retracted)
SELECT
  e,
  v AS name,
  tx AS asserted_tx,
  retracted_by
FROM attr_person_name
ORDER BY e, tx`}
/>

## DELETE: Removing Entities

Delete through the view—all datoms for that entity are retracted:

<LiveExample
  title="Delete a Person"
  code={`-- Delete Bob
DELETE FROM persons WHERE name = 'Bob';

-- Verify deletion
SELECT * FROM persons ORDER BY name`}
/>

## Checking Retracted Datoms

The data isn't gone—just retracted:

<LiveExample
  title="View Retracted Datoms"
  code={`-- See retracted datoms
SELECT
  e,
  v AS name,
  tx AS asserted_tx,
  retracted_by
FROM attr_person_name
WHERE retracted_by IS NOT NULL`}
/>

## Key Takeaways

1. **Views look like tables**: Standard SQL INSERT/UPDATE/DELETE work
2. **Data is never deleted**: Updates create new datoms and retract old ones
3. **Full history preserved**: You can query retracted datoms for audit trails
4. **Atomic transactions**: Each operation creates a new transaction

Try modifying the examples above—the database resets when you click "Reset DB".
